/*
 * Decompiled with CFR 0.145.
 * 
 * Could not load the following classes:
 *  net.minecraft.class_2246
 *  net.minecraft.class_2248
 *  net.minecraft.class_2338
 *  net.minecraft.class_238
 *  net.minecraft.class_2382
 *  net.minecraft.class_2680
 *  net.minecraft.class_310
 *  net.minecraft.class_4587
 *  net.minecraft.class_638
 *  net.minecraft.class_746
 */
package dev.recollect.hana.mod.modules.impl.exploit.dev;

import dev.recollect.hana.Hana;
import dev.recollect.hana.api.events.eventbus.EventBus;
import dev.recollect.hana.api.events.eventbus.EventHandler;
import dev.recollect.hana.api.events.impl.MoveEvent;
import dev.recollect.hana.api.events.impl.Render3DEvent;
import dev.recollect.hana.api.managers.CommandManager;
import dev.recollect.hana.api.utils.render.Render3DUtil;
import dev.recollect.hana.mod.modules.Module;
import dev.recollect.hana.mod.modules.settings.impl.BooleanSetting;
import dev.recollect.hana.mod.modules.settings.impl.ColorSetting;
import dev.recollect.hana.mod.modules.settings.impl.SliderSetting;
import dev.recollect.hana.socket.network.info.record.OnlineUserInfo;
import java.awt.Color;
import java.io.FileWriter;
import java.io.IOException;
import java.io.PrintStream;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.Iterator;
import java.util.List;
import java.util.Map;
import java.util.Set;
import net.minecraft.class_2246;
import net.minecraft.class_2248;
import net.minecraft.class_2338;
import net.minecraft.class_238;
import net.minecraft.class_2382;
import net.minecraft.class_2680;
import net.minecraft.class_310;
import net.minecraft.class_4587;
import net.minecraft.class_638;
import net.minecraft.class_746;
import org.bytedeco.javacv.BaseSettings;

public class StashFinder
extends Module {
    private long lastMessageTime;
    private Map<class_2338, Integer> chunkStashCounts;
    private int currentYawChangeInterval;
    private final ColorSetting chestColor;
    private final SliderSetting stashCountThreshold;
    private final SliderSetting yawChangeIntervalIncrease;
    private final SliderSetting range;
    private final SliderSetting messageInterval;
    private final SliderSetting blocksToChangeYaw;
    private class_2338 lastPlayerPos;
    private int direction;
    private int step;
    private final BooleanSetting render;
    private final BooleanSetting searchNearby;
    private final BooleanSetting countPerChunk;
    private int blocksWalked;
    private long lastYawChangeTime;
    private int currentRadius;
    private List<class_2338> stashLocations;
    private final SliderSetting initialYawChangeInterval;

    /*
     * Enabled force condition propagation
     * Lifted jumps to return sites
     */
    private /* synthetic */ void saveChunkStashesToFile(class_2338 a4, int a22) {
        FileWriter a32;
        StashFinder stashFinder = a32;
        a32 = new FileWriter(OnlineUserInfo.ALLATORIxDEMO(":W/\u000fFp\fA-J\t@0I,n.J1[7P \u000b&J1"), true);
        try {
            a32.write("Chunk at (" + a4.method_10263() + ", " + a4.method_10264() + ", " + a4.method_10260() + ") with " + a22 + " stashes\n");
            System.out.println(BaseSettings.ALLATORIxDEMO("wi\\r^ \u00046]zI4Js@nB#Cd[}\u0013bIg\u001caNt\u0016\u001diWXvSRYkPwwuSjBlI{\u0012}Sj"));
        }
        catch (Throwable a4) {
            Throwable throwable;
            try {
                a32.close();
                throwable = a4;
                throw throwable;
            }
            catch (Throwable a22) {
                try {
                    Throwable throwable2 = a4;
                    throwable = throwable2;
                    throwable2.addSuppressed(a22);
                    throw throwable;
                }
                catch (IOException a32) {
                    a32.printStackTrace();
                    return;
                }
            }
        }
        a32.close();
    }

    @Override
    public void onEnable() {
        StashFinder a;
        StashFinder stashFinder = a;
        StashFinder stashFinder2 = a;
        StashFinder stashFinder3 = a;
        stashFinder3.stashLocations.clear();
        stashFinder3.chunkStashCounts.clear();
        stashFinder3.currentRadius = 1;
        stashFinder2.step = 0;
        stashFinder2.direction = 1;
        a.lastMessageTime = 0L;
        a.blocksWalked = 0;
        stashFinder.currentYawChangeInterval = (int)(a.initialYawChangeInterval.getValue() * 1000.0);
        stashFinder.lastYawChangeTime = 0L;
        Hana.EVENT_BUS.subscribe(a);
    }

    @EventHandler
    public void onWorldRender(Render3DEvent render3DEvent) {
        Render3DEvent a = render3DEvent;
        StashFinder a2 = this;
        if (a2.render.getValue()) {
            a2.onRender3D(a.getMatrixStack(), a.getPartialTicks());
        }
    }

    /*
     * WARNING - void declaration
     */
    private /* synthetic */ void sendChunkChatMessage(class_2338 class_23382, int n) {
        void a;
        StashFinder a2 = class_23382;
        StashFinder a3 = this;
        CommandManager.sendChatMessage("Found chunk at (" + a2.method_10263() + ", " + a2.method_10264() + ", " + a2.method_10260() + ") with " + (int)a + " stashes");
    }

    public StashFinder() {
        StashFinder a;
        StashFinder stashFinder = a;
        StashFinder stashFinder2 = a;
        StashFinder stashFinder3 = a;
        StashFinder stashFinder4 = a;
        StashFinder stashFinder5 = a;
        StashFinder stashFinder6 = a;
        super(BaseSettings.ALLATORIxDEMO("KTwkyDdDj{aRmNl"), Module.Category.Exploit);
        StashFinder stashFinder7 = a;
        stashFinder7.render = stashFinder6.add(new BooleanSetting(OnlineUserInfo.ALLATORIxDEMO("v6K6W7"), true));
        stashFinder6.searchNearby = stashFinder6.add(new BooleanSetting(BaseSettings.ALLATORIxDEMO("LOQwTjsm]{Ig"), true));
        stashFinder6.countPerChunk = stashFinder6.add(new BooleanSetting(OnlineUserInfo.ALLATORIxDEMO("\u001ci\u0004G*~<V\u0010M'\\."), true));
        stashFinder6.range = stashFinder6.add(new SliderSetting(BaseSettings.ALLATORIxDEMO("Z]gL{"), 10.0, 1.0, 390.0, 1.0));
        stashFinder6.stashCountThreshold = stashFinder6.add(new SliderSetting(OnlineUserInfo.ALLATORIxDEMO("\u0010U7@,k0s\u001f]\nF+A M=^!"), 5.0, 1.0, 100.0, 1.0));
        stashFinder6.chestColor = stashFinder6.add(new ColorSetting(BaseSettings.ALLATORIxDEMO("smRqIKSeDl"), new Color(255, 255, 255, 100)).injectBoolean(false));
        stashFinder6.messageInterval = stashFinder6.add(new SliderSetting(OnlineUserInfo.ALLATORIxDEMO("\tM,u\u0010N;g7P6W$S)"), 1.0, 0.1, 10.0, 0.1));
        stashFinder6.blocksToChangeYaw = stashFinder6.add(new SliderSetting(BaseSettings.ALLATORIxDEMO("OFpRol~_F_cSoYPJi"), 10.0, 1.0, 100.0, 1.0));
        stashFinder6.initialYawChangeInterval = stashFinder6.add(new SliderSetting(OnlineUserInfo.ALLATORIxDEMO("'wz\u0010]\"M\u000fR3k7g\u001fN;g7P6W$S)"), 1.0, 0.1, 10.0, 0.1));
        stashFinder6.yawChangeIntervalIncrease = stashFinder6.add(new SliderSetting(BaseSettings.ALLATORIxDEMO("C\u00165IWLv_hcqEam\\Qi~l^zYhX{"), 0.1, 0.01, 1.0, 0.01));
        stashFinder5.stashLocations = new ArrayList<class_2338>();
        stashFinder5.chunkStashCounts = new HashMap<class_2338, Integer>();
        stashFinder5.currentRadius = 1;
        stashFinder4.step = 0;
        stashFinder4.direction = 1;
        stashFinder3.lastMessageTime = 0L;
        stashFinder3.blocksWalked = 0;
        stashFinder2.currentYawChangeInterval = 0;
        stashFinder2.lastYawChangeTime = 0L;
        stashFinder2.lastPlayerPos = new class_2338(0, 0, 0);
        stashFinder.setDescription(OnlineUserInfo.ALLATORIxDEMO("\u001e@0P0NxJ7\u0005:_&\u0006uz\u0003\\7Rv@0I,nQE1M8P:J<Ak"));
        stashFinder.setChinese(BaseSettings.ALLATORIxDEMO("\u81e8\u5295\u6276\u57c6\u5739\u6d60\u8bcb"));
    }

    @Override
    public void onRender3D(class_4587 a, float a2) {
        StashFinder a3;
        StashFinder stashFinder = a3;
        Iterator<class_2338> iterator = a2 = stashFinder.stashLocations.iterator();
        while (iterator.hasNext()) {
            a3 = a2.next();
            a3 = new class_238((class_2338)a3);
            iterator = a2;
            Render3DUtil.draw3DBox(a, (class_238)a3, stashFinder.chestColor.getValue());
        }
    }

    private /* synthetic */ void checkAndChangeYaw() {
        long l;
        StashFinder a;
        if ((double)a.blocksWalked >= a.blocksToChangeYaw.getValue() && (l = System.currentTimeMillis()) - a.lastYawChangeTime >= (long)a.currentYawChangeInterval) {
            a.changeYaw();
            a.blocksWalked = 0;
            a.currentYawChangeInterval += (int)(a.yawChangeIntervalIncrease.getValue() * 1000.0);
            a.lastYawChangeTime = l;
        }
    }

    @Override
    public void onDisable() {
        StashFinder a;
        StashFinder stashFinder = a;
        stashFinder.stashLocations.clear();
        stashFinder.chunkStashCounts.clear();
        Hana.EVENT_BUS.unsubscribe(a);
    }

    private /* synthetic */ boolean isStashBlock(class_2248 class_22482) {
        StashFinder a = class_22482;
        StashFinder a2 = this;
        return a == class_2246.field_10034 || a == class_2246.field_10380 || a == class_2246.field_10603 || a == class_2246.field_10121;
    }

    /*
     * WARNING - void declaration
     */
    private /* synthetic */ void sendChatMessage(class_2338 class_23382, int n) {
        void a;
        StashFinder a2 = class_23382;
        StashFinder a3 = this;
        CommandManager.sendChatMessage("Found stash at (" + a2.method_10263() + ", " + a2.method_10264() + ", " + a2.method_10260() + ") with " + (int)a + " nearby stashes");
    }

    private /* synthetic */ int countNearbyStashes(class_2338 a) {
        int n;
        StashFinder a22;
        StashFinder stashFinder = a22;
        int n2 = 0;
        int a22 = (int)stashFinder.range.getValue();
        int n3 = n = -a22;
        while (n3 <= a22) {
            int n4 = -a22;
            while (n4 <= a22) {
                int n5;
                int n6 = -a22;
                while (n6 <= a22) {
                    int n7;
                    class_2338 class_23382 = a.method_10069(n, n5, n7);
                    if (stashFinder.isStashBlock((class_23382 = StashFinder.mc.field_1687.method_8320(class_23382)).method_26204())) {
                        ++n2;
                    }
                    n6 = ++n7;
                }
                n4 = ++n5;
            }
            n3 = ++n;
        }
        return n2;
    }

    /*
     * WARNING - void declaration
     */
    private /* synthetic */ void sendMessageWithDelay(class_2338 class_23382, int n) {
        long l;
        int a = n;
        StashFinder a2 = this;
        long l2 = System.currentTimeMillis();
        if ((double)(l - a2.lastMessageTime) >= a2.messageInterval.getValue() * 1000.0) {
            void a3;
            a2.sendChatMessage((class_2338)a3, a);
            a2.lastMessageTime = l2;
        }
    }

    private /* synthetic */ void changeYaw() {
        StashFinder a22;
        StashFinder stashFinder = a22;
        float a22 = (StashFinder.mc.field_1724.method_36454() + 90.0f) % 360.0f;
        StashFinder.mc.field_1724.method_36456(a22);
    }

    @EventHandler
    public void onMove(MoveEvent moveEvent) {
        Object a = moveEvent;
        StashFinder a2 = this;
        if (StashFinder.mc.field_1724 != null && !a2.lastPlayerPos.equals(a = new class_2338((class_2382)StashFinder.mc.field_1724.method_24515()))) {
            StashFinder stashFinder = a2;
            ++stashFinder.blocksWalked;
            stashFinder.lastPlayerPos = a;
            stashFinder.checkAndChangeYaw();
        }
    }

    /*
     * Enabled force condition propagation
     * Lifted jumps to return sites
     */
    private /* synthetic */ void saveStashesToFile(class_2338 a4, int a22) {
        FileWriter a32;
        StashFinder stashFinder = a32;
        a32 = new FileWriter(OnlineUserInfo.ALLATORIxDEMO("\u0006x}\u0005k0U7@,w3i\u0012H*G6J \u000b&J1"), true);
        try {
            a32.write("Stash at (" + a4.method_10263() + ", " + a4.method_10264() + ", " + a4.method_10260() + ") with " + a22 + " nearby stashes\n");
            System.out.println(BaseSettings.ALLATORIxDEMO("$6]zI4EsVaBj_k\rk\u00164Xl\u001c}@:\u001f#d^rkLlYwnhpIQq^mS{\u0012}Sj"));
        }
        catch (Throwable a4) {
            Throwable throwable;
            try {
                a32.close();
                throwable = a4;
                throw throwable;
            }
            catch (Throwable a22) {
                try {
                    Throwable throwable2 = a4;
                    throwable = throwable2;
                    throwable2.addSuppressed(a22);
                    throw throwable;
                }
                catch (IOException a32) {
                    a32.printStackTrace();
                    return;
                }
            }
        }
        a32.close();
    }

    private /* synthetic */ void findStashes() {
        StashFinder a22;
        StashFinder stashFinder;
        int n;
        int n2;
        StashFinder stashFinder2 = stashFinder = a22;
        stashFinder2.stashLocations.clear();
        stashFinder2.chunkStashCounts.clear();
        int n3 = (int)stashFinder2.range.getValue();
        int n4 = n2 = -n3;
        while (n4 <= n3) {
            int n5 = -n3;
            while (n5 <= n3) {
                int n6 = -n3;
                while (n6 <= n3) {
                    class_2338 class_23382 = new class_2338((class_2382)StashFinder.mc.field_1724.method_24515()).method_10069(n2, a22, n);
                    class_2680 class_26802 = StashFinder.mc.field_1687.method_8320(class_23382);
                    if (stashFinder.isStashBlock(class_26802.method_26204())) {
                        StashFinder stashFinder3 = stashFinder;
                        stashFinder3.stashLocations.add(class_23382);
                        if (stashFinder3.countPerChunk.getValue()) {
                            class_23382 = new class_2338(class_23382.method_10263() >> 4, class_23382.method_10264() >> 4, class_23382.method_10260() >> 4);
                            StashFinder stashFinder4 = stashFinder;
                            class_2338 class_23383 = class_23382;
                            stashFinder4.chunkStashCounts.put(class_23383, stashFinder4.chunkStashCounts.getOrDefault((Object)class_23383, 0) + 1);
                        }
                    }
                    n6 = ++n;
                }
                n5 = ++a22;
            }
            n4 = ++n2;
        }
        if (stashFinder.searchNearby.getValue()) {
            for (class_2338 a22 : stashFinder.stashLocations) {
                int n7;
                n = stashFinder.countNearbyStashes(a22);
                if (!((double)n7 > stashFinder.stashCountThreshold.getValue())) continue;
                StashFinder stashFinder5 = stashFinder;
                stashFinder5.saveStashesToFile(a22, n);
                stashFinder5.sendMessageWithDelay(a22, n);
            }
        }
        if (stashFinder.countPerChunk.getValue()) {
            for (Map.Entry<class_2338, Integer> a22 : stashFinder.chunkStashCounts.entrySet()) {
                Map.Entry<class_2338, Integer> entry;
                if (!((double)entry.getValue().intValue() > stashFinder.stashCountThreshold.getValue())) continue;
                stashFinder.saveChunkStashesToFile(a22.getKey(), a22.getValue());
                stashFinder.sendChunkChatMessage(a22.getKey(), a22.getValue());
            }
        }
    }
}
